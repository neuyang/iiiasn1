
original code was take from  http://iiiasn1.sourceforge.net

striping/simplifying/improving
